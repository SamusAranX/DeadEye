<Window x:Class="DeadEye.Windows.ScreenshotFrameWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DeadEye"
        xmlns:controls="clr-namespace:DeadEye.Controls"
        Loaded="ScreenshotFrameWindow_OnLoaded"
        mc:Ignorable="d" WindowStyle="None" Background="#000000" ResizeMode="NoResize"
        Title="ScreenshotFrameWindow" Height="480" Width="640" DataContext="{Binding RelativeSource={RelativeSource Self}}"
        ContentRendered="ScreenshotFrameWindow_OnContentRendered" KeyDown="ScreenshotFrameWindow_OnKeyDown" KeyUp="ScreenshotFrameWindow_OnKeyUp"
        RenderOptions.BitmapScalingMode="NearestNeighbor" UseLayoutRounding="True" LostFocus="ScreenshotFrameWindow_OnLostFocus"
        MouseLeftButtonDown="ScreenshotFrameWindow_OnMouseLeftButtonDown" MouseMove="ScreenshotFrameWindow_OnMouseMove" MouseLeftButtonUp="ScreenshotFrameWindow_OnMouseLeftButtonUp">
	<Window.Resources>
        <Storyboard x:Key="FadeInStoryboard">
			<DoubleAnimation Duration="0:0:0.1" From="0" To="1" FillBehavior="HoldEnd" Storyboard.TargetName="DragOverlay" Storyboard.TargetProperty="Opacity">
                <DoubleAnimation.EasingFunction>
	                <CubicEase EasingMode="EaseInOut" />
                </DoubleAnimation.EasingFunction>
			</DoubleAnimation>
        </Storyboard>

		<RectangleGeometry x:Key="FullscreenRect"  Rect="0,0,32767,32767" />

		<SolidColorBrush x:Key="GridUnselected" Color="#66000000" />
	</Window.Resources>

	<Grid>
		<Image Source="{Binding ScreenshotSource}" />

		<Border x:Name="DragOverlay" Background="{StaticResource GridUnselected}" Opacity="0">
			<Border.Clip>
				<GeometryGroup>
					<StaticResource ResourceKey="FullscreenRect" />
					<RectangleGeometry Rect="{Binding SelectionBounds}" />
				</GeometryGroup>
			</Border.Clip>
		</Border>

		<Canvas Background="Transparent">
			<controls:RuleOfThirdsGrid Opacity="0.4"
			                           Canvas.Top="{Binding SelectionBoundsClamped.Top}"
			                           Canvas.Left="{Binding SelectionBoundsClamped.Left}"
			                           Width="{Binding SelectionBoundsClamped.Width}"
			                           Height="{Binding SelectionBoundsClamped.Height}" />
		</Canvas>
	</Grid>
</Window>
